{% extends "base.html" %}

{% block title %}{{ 'Editar' if dependente else 'Novo' }} Dependente{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h3 mb-0">
            <i class="fas fa-user-friends me-2"></i>{{ 'Editar' if dependente else 'Novo' }} Dependente
        </h1>
        <a href="{{ url_for('ci.detalhes', id=ci.id) }}" class="btn btn-secondary">
            <i class="fas fa-arrow-left me-1"></i> Voltar
        </a>
    </div>

    <div class="card">
        <div class="card-header">
            <i class="fas fa-user me-1"></i> Colaborador: {{ ci.nome }}
        </div>
        <div class="card-body">
            <form method="POST" action="{{ url_for('ci.editar_dependente', ci_id=ci.id, dep_id=dependente.id) if dependente else url_for('ci.novo_dependente', id=ci.id) }}">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Nome Completo *</label>
                        <input type="text" name="nome" class="form-control" required
                               value="{{ form_data.nome if form_data else (dependente.nome if dependente else '') }}">
                    </div>
                    <div class="col-md-3 mb-3">
                        <label class="form-label">CPF</label>
                        <input type="text" name="cpf" class="form-control"
                               value="{{ form_data.cpf if form_data else (dependente.cpf if dependente else '') }}">
                    </div>
                    <div class="col-md-3 mb-3">
                        <label class="form-label">Data de Nascimento</label>
                        <input type="date" name="data_nascimento" class="form-control"
                               value="{{ form_data.data_nascimento if form_data else (dependente.data_nascimento.strftime('%Y-%m-%d') if dependente and dependente.data_nascimento else '') }}">
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label class="form-label">Parentesco *</label>
                        <select name="parentesco" class="form-select" required>
                            <option value="">Selecione...</option>
                            <option value="CONJUGE" {{ 'selected' if (form_data and form_data.parentesco == 'CONJUGE') or (dependente and dependente.parentesco == 'CONJUGE') }}>Conjuge</option>
                            <option value="FILHO" {{ 'selected' if (form_data and form_data.parentesco == 'FILHO') or (dependente and dependente.parentesco == 'FILHO') }}>Filho(a)</option>
                            <option value="ENTEADO" {{ 'selected' if (form_data and form_data.parentesco == 'ENTEADO') or (dependente and dependente.parentesco == 'ENTEADO') }}>Enteado(a)</option>
                            <option value="PAI" {{ 'selected' if (form_data and form_data.parentesco == 'PAI') or (dependente and dependente.parentesco == 'PAI') }}>Pai</option>
                            <option value="MAE" {{ 'selected' if (form_data and form_data.parentesco == 'MAE') or (dependente and dependente.parentesco == 'MAE') }}>Mae</option>
                            <option value="OUTRO" {{ 'selected' if (form_data and form_data.parentesco == 'OUTRO') or (dependente and dependente.parentesco == 'OUTRO') }}>Outro</option>
                        </select>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label">Sexo</label>
                        <select name="sexo" class="form-select">
                            <option value="">Selecione...</option>
                            <option value="M" {{ 'selected' if (form_data and form_data.sexo == 'M') or (dependente and dependente.sexo == 'M') }}>Masculino</option>
                            <option value="F" {{ 'selected' if (form_data and form_data.sexo == 'F') or (dependente and dependente.sexo == 'F') }}>Feminino</option>
                        </select>
                    </div>
                </div>

                <hr>
                <div class="d-flex justify-content-end">
                    <a href="{{ url_for('ci.detalhes', id=ci.id) }}" class="btn btn-secondary me-2">Cancelar</a>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save me-1"></i> Salvar
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
